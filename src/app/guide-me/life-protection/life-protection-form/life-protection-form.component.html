<form id="lifeProtectionForm" name="lifeProtectionForm" [formGroup]="lifeProtectionForm">
  <div class="next-btn mb10 hidden-sm-md">
    <i class="prev-arrow" (click)="navigateDependentForm('prev')" [style.visibility]="isNavPrevEnabled ? 'visible' : 'hidden'"></i>
    Dependent {{ !isFormControlDisabled ? activeFormIndex+1 : 0}}
    <i class="next-arrow" (click)="navigateDependentForm('next')" [style.visibility]="isNavNextEnabled ? 'visible' : 'hidden'"></i>
  </div>
  <div class="form-group flex-row mt30 hidden-lg">
    <label style="flex:1">I have</label>
    <div class="dropdown-control">
      <div ngbDropdown class="d-inline-block" id="dependentCountMobile">
        <button class="btn btn-default fixed-btn--md" id="dropdownBasic1" ngbDropdownToggle aria-expanded="false">
          <span>{{dependentCount}}</span>&nbsp;Dependent<span *ngIf="dependentCount > 1">s</span>
        </button>
        <div ngbDropdownMenu class="dropdown" aria-labelledby="dropdownBasic1">
          <button class="dropdown-item fixed-btn--lg" *ngFor="let option of dependentCountOptions" (click)="setDropDownDependentCount(option, i)">{{option}}</button>
        </div>
      </div>
    </div>
  </div>
  <div class="form-with-bg" [class.show]="activeFormIndex == i" formArrayName="dependents" *ngFor="let item of lifeProtectionForm.get('dependents').controls; let i = index;">
    <div [formGroupName]="i">
      <div class="overlay-block"></div>
      <!--Form Header-->
      <div>
        <div class="form-with-bg--header">
          <div class="form-group flex-row">
            <div class="form-with-bg--header-single-label">Dependent {{ !isFormControlDisabled ? i+1 : 0}}</div>
          </div>
        </div>
        <!--Form Content-->
        <div class="form-with-bg--content">
          <div class="form-group flex-row">
            <div class="form-with-bg--content-label" for="name">Gender</div>
            <div class="dropdown-control">
              <span class="arrow"></span>
              <div ngbDropdown class="d-inline-block" id="RetirementAgeDropDown">
                <button [attr.disabled]="isFormControlDisabled" class="btn btn-default btn-dropdown" id="dropdownBasic1" ngbDropdownToggle>{{item.controls.gender.value}}
                </button>
                <div class="dropdown" ngbDropdownMenu aria-labelledby="dropdownBasic1">
                  <button class="dropdown-item" *ngFor="let option of genderOptions" (click)="setDropDownValue('gender', option, i)">{{option}}</button>
                </div>
              </div>
            </div>
          </div>
          <div class="form-group flex-row">
            <div class="form-with-bg--content-label" for="name">Relationship</div>
            <div class="dropdown-control">
              <span class="arrow"></span>
              <div ngbDropdown class="d-inline-block" id="RetirementAgeDropDown">
                <button [attr.disabled]="isFormControlDisabled" class="btn btn-default btn-dropdown" id="dropdownBasic1" ngbDropdownToggle>{{item.controls.relationship.value}}
                </button>
                <div class="dropdown" ngbDropdownMenu aria-labelledby="dropdownBasic1">
                  <button class="dropdown-item" *ngFor="let option of relationshipOptions" (click)="setDropDownValue('relationship',option, i)">{{option}}</button>
                </div>
              </div>
            </div>
          </div>
          <div class="form-group flex-row">
            <div class="form-with-bg--content-label" for="name">Age</div>
            <div class="dropdown-control">
              <span class="arrow"></span>
              <div ngbDropdown class="d-inline-block" id="RetirementAgeDropDown">
                <button [attr.disabled]="isFormControlDisabled" class="btn btn-default btn-dropdown" id="dropdownBasic1" ngbDropdownToggle>{{item.controls.age.value}}
                </button>
                <div class="dropdown" ngbDropdownMenu aria-labelledby="dropdownBasic1">
                  <button class="dropdown-item" *ngFor="let option of ageOptions" (click)="setDropDownValue('age',option, i)">{{option}}</button>
                </div>
              </div>
            </div>
          </div>
          <div class="form-group flex-row">
            <div class="form-with-bg--content-label" for="name">
              <a href="#" class="link">Support Amount</a>
              <span class="help-icon" (click)="showLifeProtectionSupportAmountModal()"></span>
            </div>
            <div name="otherIncome" class="input-control" [ngClass]="{'readonly': otherIncome.value != 0}">
              <span class="fixed-currency">$</span>
              <input [attr.disabled]="isFormControlDisabled" type="text" class="input-with-suffix" (change)="updateSlider()" appCurrencyInput
                maxLength="4" #otherIncome formControlName="otherIncome" value="0">
              <span class="fixed-tenure">{{ 'MY_INCOME.PER_MONTH' | translate}}</span>
            </div>
          </div>
          <!--   <nouislider #noUiSlider (slide)="onNoUiSliderChange($event)" [config]="incomeSliderConfig" [min]="0" [max]="9999" [step]="50" [tooltips]="[ false ]"></nouislider> -->
          <div class="form-group flex-row">
            <div class="form-with-bg--content-label" for="name">
              <a href="#" class="link">Years Needed</a>
              <span class="help-icon" (click)="showLifeProtectionModal()"></span>
            </div>
            <div class="dropdown-control">
              <!-- <button class="arrow" type="button"></button> -->
              <div ngbDropdown class="d-inline-block" id="RetirementAgeDropDown">
                <button [attr.disabled]="isFormControlDisabled" class="btn btn-default btn-dropdown" id="dropdownBasic1" ngbDropdownToggle>{{item.controls.yearsNeeded.value}}
                </button>
                <div class="dropdown" ngbDropdownMenu aria-labelledby="dropdownBasic1">
                  <button class="dropdown-item" *ngFor="let option of yearsNeededOptions" (click)="setDropDownValue('yearsNeeded',option, i)">{{option}}</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div *ngIf="isChild(item.controls.age.value)">
        <div class="education-support">
          <div class="checkbox-button one-label">
            <input [attr.disabled]="isFormControlDisabled" id="educationSupport{{i}}" name="educationSupport" formControlName="educationSupport" type="checkbox" class="field checkbox"
              value="Education Support <br> I want to fund this child for a university education if i pass away">
            <label for="educationSupport{{i}}">
              <div>Education Support
                <br> I want to fund this child for a university education if i pass away</div>
            </label>
          </div>
        </div>
        <div class="education-support-details" *ngIf="item.controls.educationSupport.value">
          <div class="form-with-bg dark">
            <label>He / She will be studying: </label>
            <div class="form-group flex-row">
              <div class="form-with-bg--content-label" for="name">Course</div>
              <div class="dropdown-control">
                <!-- <button class="arrow" type="button"></button> -->
                <div ngbDropdown class="d-inline-block" id="RetirementAgeDropDown">
                  <button [attr.disabled]="isFormControlDisabled" class="btn btn-default btn-dropdown" id="dropdownBasic1" ngbDropdownToggle>Medicine
                  </button>
                  <div class="dropdown" ngbDropdownMenu aria-labelledby="dropdownBasic1">
                    <button class="dropdown-item" *ngFor="let option of yearsNeededOptions" (click)="setDropDownValue('yearsNeeded',option, i)">{{option}}</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group flex-row">
              <div class="form-with-bg--content-label" for="name">Country</div>
              <div class="dropdown-control">
                <!-- <button class="arrow" type="button"></button> -->
                <div ngbDropdown class="d-inline-block" id="RetirementAgeDropDown">
                  <button [attr.disabled]="isFormControlDisabled" class="btn btn-default btn-dropdown" id="dropdownBasic1" ngbDropdownToggle>Singapore
                  </button>
                  <div class="dropdown" ngbDropdownMenu aria-labelledby="dropdownBasic1">
                    <button class="dropdown-item" *ngFor="let option of yearsNeededOptions" (click)="setDropDownValue('yearsNeeded',option, i)">{{option}}</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group flex-row">
              <div class="form-with-bg--content-label" for="name">Nationality</div>
              <div class="dropdown-control">
                <!-- <button class="arrow" type="button"></button> -->
                <div ngbDropdown class="d-inline-block" id="RetirementAgeDropDown">
                  <button [attr.disabled]="isFormControlDisabled" class="btn btn-default btn-dropdown" id="dropdownBasic1" ngbDropdownToggle>Singaporean
                  </button>
                  <div class="dropdown" ngbDropdownMenu aria-labelledby="dropdownBasic1">
                    <button class="dropdown-item" *ngFor="let option of yearsNeededOptions" (click)="setDropDownValue('yearsNeeded',option, i)">{{option}}</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Action Buttons -->
  <button id="nextDependentBtn" [class.show]="isNavNextEnabled" (click)="navigateDependentForm('next')" type="button" class="btn btn__footer--fixed btn-ftr-get-started btn-primary width100">Next Dependent</button>
  <button id="submitDepFormBtn" [class.show]="!isNavNextEnabled" (click)="submitDependentForm()" type="button" class="btn btn__footer--fixed btn-ftr-get-started btn-primary width100">Continue</button>

  <!-- PAGE INDICATOR -->
  <div class="page-indicator" *ngIf="!isFormControlDisabled">
    <span [class.active]="i == activeFormIndex" *ngFor="let item of getPageIndicatorCount(); let i = index;"></span>
  </div>

</form>

