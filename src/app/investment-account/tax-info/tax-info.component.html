<div class="app-tax-info">
  <div class="step-indicator-container">
    <div class="container-fluid">
      <app-step-indicator [count]="9" [activeStepIndex]="4"></app-step-indicator>
    </div>
  </div>
  <div class="container-fluid">
    <form name="taxInfoForm" [formGroup]="taxInfoForm">
      <div formArrayName="addTax" class="tax-form" *ngFor="let taxInfoItem of taxInfoForm.controls.addTax.controls; let x = index">
        <div [formGroupName]="x">
          <div class="flex-row">
            <div class="flex-col-4">
              <label for="name" class="country_text" id="tax-info-label">{{ 'TAX_INFO.COUNTRY_TEXT' | translate}}</label>
            </div>
            <div class="flex-col-8">

              <div class="dropdown-control" [ngClass]="{'inline-error':getInlineErrorStatus(taxInfoItem.controls.taxCountry)}">
                <div ngbDropdown>

                  <button class="btn btn-dropdown" ngbDropdownToggle>
                    <span *ngIf="taxInfoItem.controls.taxCountry.value" class="dependent-count dropdown_text" id="tax_Info_dropdown_country">{{ taxInfoItem.controls.taxCountry.value.name | titlecase }}</span>
                    <span *ngIf="!taxInfoItem.controls.taxCountry.value" class="dependent-count dropdown_text" id="tax_Info_dropdown_country">Select Country</span>
                    <!-- <span class="dependent-count" id="select_nationality_dropdown_defaltvalue">Select Country</span> -->

                  </button>

                  <div class="dropdown dropdown-lg" ngbDropdownMenu aria-labelledby="dropdownBasic1">
                    <button class="dropdown-item" *ngFor="let country of countries; let i = index;" (click)="selectCountry(country , taxInfoItem)"
                      id="selectNationality-country-option-{{i}}">
                      {{country.name | titlecase}}
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>



          <!-- PLACEHOLDER -->
          <!-- Do you have a TIN question -->
          <div class="flex-row mb10">
            <div class="flex-col-11 mt15">
              <div class="tin_question_text" id="tax_Info_question-one">{{ 'TAX_INFO.TIN_QUESTION' | translate}}
              </div>
            </div>
            <div class="flex-col-1">
              <i class="tooltip-icon" id="myFinancialHelpIcon" (click)="showHelpModal()"></i>
            </div>
          </div>
          <!-- Button part -->
          <div class="flex-row">
            <div class="flex-col-12 mb20">
              <div class="btn-group--toggle" ngbRadioGroup name="radioTin" formControlName="radioTin">
                <div class="flex-row">
                  <div class="flex-col-6">
                    <label ngbButtonLabel class="btn-outline-primary fixed-btn--sm mr16">
                      <input ngbButton type="radio" id="tin_yes" [value]=true (change)="isTinNumberAvailChanged(true , taxInfoItem, null)"> {{ 'TAX_INFO.YES_lABEL' | translate}}
                    </label>
                  </div>
                  <div class="flex-col-6">
                    <label ngbButtonLabel class="btn-outline-primary fixed-btn--sm mr16">
                      <input ngbButton type="radio" id="tin_no" [value]=false (change)="isTinNumberAvailChanged(false , taxInfoItem, null)">{{ 'TAX_INFO.NO_LABEL' | translate}}</label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Second Dropdown -->
          <div class="flex-row" *ngIf=" taxInfoItem.controls.radioTin.value === false">
            <div class="flex-col-4">
              <label class="tin_question_text pb10" for="name" id="tax-info-reason_label">{{ 'TAX_INFO.REASON_TEXT' | translate}}</label>
            </div>
            <div class="flex-col-8">
              <div class="dropdown-control" [ngClass]="{'inline-error':getInlineErrorStatus( taxInfoItem.controls.noTinReason)}">
                <div ngbDropdown>

                  <button class="btn btn-dropdown" ngbDropdownToggle>
                    <span *ngIf=" taxInfoItem.controls.noTinReason.value" class="dependent-count" id="tax_Info_dropdown_country">{{taxInfoItem.controls.noTinReason.value.name | titlecase }}</span>
                    <span *ngIf="! taxInfoItem.controls.noTinReason.value" class="dependent-count" id="tax_Info_dropdown_country">Select</span>
                    <!-- <span class="dependent-count" id="select_nationality_dropdown_defaltvalue">Select Country</span> -->

                  </button>

                  <div class="dropdown dropdown-lg" ngbDropdownMenu aria-labelledby="dropdownBasic1">
                    <button class="dropdown-item" *ngFor="let reasonListObj of noTinReasonlist; let i = index;" (click)="selectReason(reasonListObj , taxInfoItem)"
                      id="selectReason-country-option-{{i}}">
                      {{reasonListObj.name}}
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Tin text box -->
          <!-- Second Dropdown -->
          <div class="flex-row" *ngIf="taxInfoItem.controls.radioTin.value === true">
            <div class="flex-col-4">
              <label class="tin_question_text pb10" for="name" id="tax-info-reason_label">{{ 'TAX_INFO.TIN_TEXT' | translate}}</label>
            </div>
            <div class="flex-col-8">
              <div class="dropdown-control" [ngClass]="{'inline-error':getInlineErrorStatus(taxInfoItem.controls.tinNumber)}">
                <input type="text" [placeholder] = "getPlaceholder( taxInfoItem.controls.taxCountry.value , taxInfoItem)" id="invPersInfoInpt1" class="form-control" formControlName="tinNumber">
              </div>
            </div>
          </div>

          <!-- <div class="circle" (click)="removeTaxForm(taxInfoForm , x)">
            <button type="button" class="close" aria-label="Close"  style="opacity: 1 !important">
              <span aria-hidden="true"></span>
            </button>
          </div> -->
          <div class="thumb-close-icon"  (click)="removeTaxForm(taxInfoForm , x)">
              <img src="../../../assets/images/close-button.svg" alt="x" />
          </div>
          <!-- <img src="assets/images/close-button-dark.svg"> -->
        </div>
      </div>
      <div class="add-tax-box" *ngIf="formCount < 4" (click)="addTaxForm(null)">
        <div>Are you paying tax in another country?</div>
        <div class="add-tax-text">Add Tax Residence</div>
      </div>
    </form>

  </div>

  <button type="button" id="personalInforNextBtn" (click)="goToNext(taxInfoForm)" class="btn btn__footer--fixed btn-ftr-get-started btn-primary width100"
    id="getStrdBtn3">{{ 'TAX_INFO.CONTINUE' | translate}}</button>
</div>